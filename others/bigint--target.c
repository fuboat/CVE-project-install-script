#include "bigint.h"

#include <assert.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

extern int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) {
    int i, j;
    if (Size < 3) {
        return 0;
    }
    bigint a[1], b[1], c[1], d[1];
    char* intData = malloc(Size * sizeof(char));
    fprintf(stderr, "!!!!!!!!!!Size: %d!!!!!!!!!!!!!!!\n", Size);
    for (i = 0; i < Size; i++) {
        intData[i] = Data[i] % 10 + '0';
        fprintf(stderr, "%c", intData[i] );
    }
    bigint_init(a);
    bigint_from_str(a, intData);
    bigint_init(b);
    bigint_init(c);
    bigint_init(d);
    bigint_from_str(b, "11111111111111111111");
    bigint_sqrt(c, a);

    bigint_shift_left(a, a, 1 << 10);

    bigint_mul(c, a, a);
    bigint_sub(c, c, a);
    bigint_add(c, c, b);

    bigint_free(a);
    bigint_free(b);
    bigint_free(c);
    bigint_free(d);
    return 0;
}


