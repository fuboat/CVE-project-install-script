//
// Created by fuboat on 2021/3/1.
//

#include <cstdio>
#include "bmp.h"

typedef unsigned int uint;

int main(int argc,char** argv)
{
    if (argc == 1)
    {
        std::printf("No Input.\n");
        return 0;
    }

    // Load File
    Bitmap *bmp = bm_load(argv[1]);
    std::printf("Load OK\n");

    // Test W&H
    int w = bm_width(bmp);
    int h = bm_height(bmp);
    std::printf("W&H OK\n");

    // Test
    bm_clip(bmp,w/4,h/4,3*w/4,3*h/4);
    bm_flip_vertical(bmp);
    bm_unclip(bmp);
    uint col = bm_get(bmp,w/8,h/8);
    bm_set(bmp,w/8,h/8,0xFFFFFFFF-col);
    std::printf("Test OK\n");

    // Save
    int sav = bm_save(bmp,"out.bmp");
    if (sav)
        std::printf("Save OK\n");
    else
    {
        std::printf("Save Crash!\n");
        throw 1;
        return 1;
    }

    // free
    bm_free(bmp);

    std::printf("Finish\n");
    return 0;
}