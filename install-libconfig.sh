#!/bin/bash

# target: ./libconfig @@

rm -rf libconfig

git clone https://github.com/hyperrealm/libconfig
cd libconfig || exit
git checkout -f f53e5de4528b47195f9a02c502e4f244070b0468

sed -i '11s/.*/option(BUILD_SHARED_LIBS  "Enable shared library" OFF)/' CMakeLists.txt

mkdir build
cd build || exit
cmake ..
make
cd ..

wget https://raw.githubusercontent.com/fuboat/CVE-project-install-script/main/others/libconfig--fuzzer2.c -O fuzzer2.c
$CC $CFLAGS $CPPFLAGS fuzzer2.c -I ./lib/  -L ./build/out/ -lconfig -o libconfig
